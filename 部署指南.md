# 🚀 迷蒙标题生成大师 - 云端部署指南

本指南提供了多种云端部署方案，选择适合你的方式进行部署。

## 📋 部署方案对比

| 平台 | 难度 | 成本 | 性能 | 推荐度 |
|------|------|------|------|--------|
| Vercel | ⭐ | 免费 | 中 | 🌟🌟🌟 |
| Railway | ⭐⭐ | 免费额度 | 高 | 🌟🌟🌟🌟 |
| 腾讯云/阿里云 | ⭐⭐⭐ | 按量付费 | 高 | 🌟🌟🌟🌟🌟 |
| Docker | ⭐⭐⭐⭐ | 自定义 | 最高 | 🌟🌟🌟🌟 |

---

## 🌟 方案一：Vercel 部署（推荐新手）

### 优点
- 完全免费
- 自动HTTPS
- 全球CDN加速
- 操作简单

### 步骤

1. **准备代码**
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   ```

2. **推送到GitHub**
   - 在GitHub创建新仓库
   - 推送代码到仓库

3. **部署到Vercel**
   - 访问 [vercel.com](https://vercel.com)
   - 登录并连接GitHub
   - 选择你的项目仓库
   - 设置环境变量 `DEEPSEEK_API_KEY`
   - 点击Deploy

4. **配置环境变量**
   在Vercel项目设置中添加：
   ```
   DEEPSEEK_API_KEY = 你的API密钥
   ```

### 注意事项
- Vercel有函数运行时间限制（免费版10秒）
- 不适合大文件处理
- 文件上传功能可能受限

---

## 🚂 方案二：Railway 部署（推荐）

### 优点
- 简单易用
- 免费额度充足
- 自动部署
- 支持文件上传

### 步骤

1. **推送代码到Git**
   ```bash
   git init
   git add .
   git commit -m "Deploy to Railway"
   git remote add origin <your-repo-url>
   git push -u origin main
   ```

2. **部署到Railway**
   - 访问 [railway.app](https://railway.app)
   - 连接GitHub账号
   - 选择项目仓库
   - 自动检测Node.js项目

3. **设置环境变量**
   在Railway项目设置中添加：
   ```
   DEEPSEEK_API_KEY = 你的API密钥
   PORT = 3000
   ```

4. **自定义域名（可选）**
   - 在Settings中设置自定义域名
   - 或使用Railway提供的域名

### 费用
- 免费额度：$5/月
- 超出后按使用量付费

---

## ☁️ 方案三：云服务器部署（推荐生产环境）

### 适用平台
- 腾讯云轻量应用服务器
- 阿里云ECS
- 华为云ECS
- 其他Linux云服务器

### 配置要求
- **最低配置**：1核2GB，带宽1Mbps
- **推荐配置**：2核4GB，带宽3Mbps
- **操作系统**：Ubuntu 20.04 LTS

### 部署步骤

1. **购买云服务器**
   - 选择Ubuntu 20.04系统
   - 开放80和443端口
   - 获取公网IP

2. **上传项目文件**
   ```bash
   # 方法1：使用scp上传
   scp -r mimeng_title root@your-server-ip:/tmp/
   
   # 方法2：使用git克隆
   git clone <your-repo-url> /var/www/mimeng-title
   ```

3. **运行部署脚本**
   ```bash
   chmod +x deploy.sh
   sudo ./deploy.sh
   ```

4. **配置环境变量**
   ```bash
   sudo nano /var/www/mimeng-title/.env
   ```
   添加：
   ```
   DEEPSEEK_API_KEY=你的API密钥
   PORT=3000
   ```

5. **重启服务**
   ```bash
   sudo systemctl restart mimeng-title
   sudo systemctl restart nginx
   ```

### 域名配置（可选）

1. **购买域名**并解析到服务器IP

2. **修改Nginx配置**
   ```bash
   sudo nano /etc/nginx/sites-available/mimeng-title
   ```
   将 `your-domain.com` 替换为你的域名

3. **安装SSL证书**
   ```bash
   sudo apt install certbot python3-certbot-nginx
   sudo certbot --nginx -d your-domain.com
   ```

---

## 🐳 方案四：Docker 部署

### 优点
- 环境一致性
- 易于扩展
- 支持容器编排

### 步骤

1. **构建镜像**
   ```bash
   docker build -t mimeng-title .
   ```

2. **运行容器**
   ```bash
   docker run -d \
     --name mimeng-title \
     -p 3000:3000 \
     -e DEEPSEEK_API_KEY=你的API密钥 \
     -v $(pwd)/uploads:/app/uploads \
     mimeng-title
   ```

3. **使用Docker Compose**
   ```bash
   # 创建.env文件设置DEEPSEEK_API_KEY
   echo "DEEPSEEK_API_KEY=你的API密钥" > .env
   
   # 启动服务
   docker-compose up -d
   ```

4. **反向代理（生产环境）**
   可以结合Nginx或Traefik进行反向代理

---

## 🔧 环境变量配置

所有部署方案都需要设置以下环境变量：

| 变量名 | 必需 | 说明 |
|--------|------|------|
| `DEEPSEEK_API_KEY` | ✅ | DeepSeek API密钥 |
| `PORT` | ❌ | 端口号（默认3000） |
| `NODE_ENV` | ❌ | 运行环境（默认development） |

---

## 🔍 部署后检查

### 健康检查
访问 `https://your-domain.com/api/health` 应该返回：
```json
{
  "status": "ok",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

### 功能测试
1. 访问主页
2. 测试文件上传功能
3. 测试URL抓取功能
4. 测试标题生成功能

### 性能监控
```bash
# 查看服务状态
systemctl status mimeng-title

# 查看日志
journalctl -u mimeng-title -f

# 查看资源使用
htop
```

---

## 🚨 常见问题

### 1. API调用失败
- 检查DEEPSEEK_API_KEY是否正确设置
- 验证网络连接
- 查看API账户余额

### 2. 文件上传失败
- 检查uploads目录权限
- 确认磁盘空间充足
- 调整文件大小限制

### 3. 内存不足
- 升级服务器配置
- 优化代码
- 添加swap空间

### 4. 域名访问失败
- 检查DNS解析
- 验证防火墙设置
- 确认SSL证书状态

---

## 💰 成本估算

### Railway
- 免费额度：$5/月
- 超出费用：约$0.0001/GB传输

### 云服务器（以腾讯云为例）
- 1核2GB：约¥50/月
- 2核4GB：约¥100/月
- 带宽费用：按实际使用计算

### 域名和SSL
- 域名：¥30-100/年
- SSL证书：免费（Let's Encrypt）

---

## 📞 技术支持

如果部署过程中遇到问题：

1. 检查部署日志
2. 查看服务器资源使用情况
3. 验证环境变量配置
4. 测试网络连接

建议选择Railway或云服务器进行部署，既简单又稳定！